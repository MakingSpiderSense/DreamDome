<!doctype html>
<html>
<head>
    <title>Synthwave Nights</title>
    <!-- The Inspector Recast library allows you to generate a nave mesh based on your entities. See Lesson 37 for details on how you use it. But essentially, you remove an items you don't want factored into the nav-mesh build first, which is the purpose of this file. Then you open the Aframe inspector and look for the plugin at the bottom. Lower the cellSize to .1 or .2 for more precision (although larger file size). Click "Build" and look if over, if you like it, click "Export" and swap out the newly generated navmesh.gltf file. The Inspector Recast library is no longer supported and only works up to version 1.2.0 of Aframe. -->
	<script src="https://aframe.io/releases/1.2.0/aframe.min.js"></script>
    <script src="https://unpkg.com/aframe-environment-component@1.3.3/dist/aframe-environment-component.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/c-frame/aframe-extras@7.1.0/dist/aframe-extras.min.js"></script>
    <script src="https://unpkg.com/aframe-aabb-collider-component@3.1.0/dist/aframe-aabb-collider-component.min.js"></script>
	<script src="https://recast-api.donmccurdy.com/aframe-inspector-plugin-recast.js"></script>
    <script src="js/components.js"></script>
</head>

<body>
	<!-- <a-scene vr-mode-ui="enabled: false"> -->
    <a-scene stats physics="driver: ammo; debug: true;" inspector-plugin-recast>

        <!-- Asset Management System -->
        <a-assets>
            <img id="neon-sky" src="assets/neon-sky-2.jpg">
            <img id="moon" src="assets/moon-3.png">
            <img id="speaker" src="assets/metal_dotted_2-specular.jpg">
            <img id="cpanel" src="assets/cpanel.jpg">
        	<audio id="ghosthustlers" src="assets/ghosthustlers--some-elses-ride.mp3"></audio>
        	<audio id="door-moving" src="assets/door-moving.mp3"></audio>
        	<audio id="elevator-moving" src="assets/elevator-moving.mp3"></audio>
            <img id="billboard-front" src="assets/billboard-front.png">
			<a-asset-item id="my-nav-mesh" src="assets/navmesh.gltf"></a-asset-item>
        </a-assets>
        
        <!-- Environment -->
        <a-entity class="env-dream" environment="preset: dream; groundColor: #445; grid: cross; fog: 0; skyType: none; seed: 3;"></a-entity>

		<!-- Navigation Mesh -->
        <!-- Left here for testing. -->
		<!-- <a-entity gltf-model="#my-nav-mesh" nav-mesh position="0 -0.1 0" visible="true">
		</a-entity> -->

        <!-- Elevator -->
        <a-entity class="elevator" position="-16 0 -14">
            <a-entity class="el-glass">
                <a-cylinder ammo-body="type: static" ammo-shape class="el-mainbody" position="0 2.5 0" color="blue" height="5" opacity=".2" radius="3" geometry="thetaLength: 300; thetaStart: 30;" material="side: double; roughness: 0;" open-ended="true"></a-cylinder>
            </a-entity>
        </a-entity>

        <!-- Speaker -->
        <a-entity class="speaker" position="7 0 8" animation="property: rotation; to: 0 -360 0; loop: true; dur: 30000;">
            <!-- Speaker Body -->
            <a-cylinder ammo-body="type: static" ammo-shape color="#333" height="10" scale="1 1 1" rotation="0 0 0" material="src: #speaker; repeat: 9 9; roughness: .7;">
            </a-cylinder>
        </a-entity>

		<!-- Camera Rig -->
        <!-- Comment this out when generating nav mesh. Left here for testing. -->
		<!-- <a-entity class="user" position="0 0 6" movement-controls="speed: 1; constrainToNavMesh: true;">
			<a-entity camera position="0 1.6 0"
					  look-controls="pointerLockEnabled: false"
                      aabb-collider="objects: #elevator-door-trigger"
                      id="cameraRig"
                      open-door
                      ammo-body="type: kinematic" ammo-shape="type: box; fit: manual; sphereRadius:0.5"
                      >
                    <a-entity cursor position="0 0 -1"
                                geometry="primitive: sphere; radius: 0.005"
                                material="color: #FFFFFF; shader: flat; opacity: 0.5"
                                raycaster="objects: .clickable">
                    </a-entity>
			</a-entity>
            <a-entity class="controllers">
                <a-entity oculus-touch-controls="hand: left"></a-entity>
                <a-entity oculus-touch-controls="hand: right"></a-entity>
            </a-entity>
        </a-entity> -->

    </a-scene>

</body>
</html>